# This is the rnaseq-pipeline configuration file.

destination_path: "/data/bioinf/projects/data/Jurkat_ChIPSeq/pipeline_out/"

constants:
    - &genome /data/bioinf/Data/Indices/hg19/hg19.fa
    - &genome_index /data/bioinf/Data/Indices/hg19/hg19.fa.fai
    - &segemehl_genome_index /data/bioinf/Data/Indices/hg19/hg19.idx
    - &bowtie2_genome_index /data/bioinf/genomes/data/animalia/chordata/mammalia/rodentia/homo_sapiens/hg19/indices/hg19 


steps:
    fc1 (run_folder_source):
        path: /data/bioinf/projects/data/Jurkat_ChIPSeq/130124_M00518_0110_000000000-A1V79_CK_Jurkat/
        paired_end: yes

    fc2 (run_folder_source):
        path: /data/bioinf/projects/data/Jurkat_ChIPSeq/130614_M00518_0155_000000000-A3G58_CK_H3K36_rabbit/
        paired_end: yes

    # Adapters are:
    # R1 sequence of the TruSeq/ScriptSeq index adapter
    # R2 reverse complement sequence of the TruSeq/ScriptSeq universal adapter 
    cutadapt:
        _depends: [fc1, fc2]
        adapter-R1: AGATCGGAAGAGCACACGTCTGAACTCCAGTCAC((INDEX))ATCTCGTATGCCGTCTTCTGCTTG
        adapter-R2: AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT
        fix_qnames: false

    fix_cutadapt:
        _depends: cutadapt

    segemehl:
        _depends: fix_cutadapt
        genome: *genome
        index: *segemehl_genome_index

    macs14_rabbit_IgG (macs14):
        _depends: segemehl
        control: [rabbit_IgG]

    rabbit_IgG_1 (macs14):
        _depends: segemehl
        control: [rabbit_IgG_1]

    rabbit_IgG_2 (macs14):
        _depends: segemehl
        control: [rabbit_IgG_2]

    s2c:
        _depends: segemehl

    fix_s2c:
        _depends: s2c

    sam_to_bam:
        _depends: fix_s2c
        sort_by_name: no
        genome: *genome

    bam_to_bed:
        _depends: sam_to_bam

    bed_to_bedgraph:
        _depends: bam_to_bed
        genome: *genome_index
        strand-specific: no

    bedgraph_to_bigwig:
        _depends: bed_to_bedgraph
        genome: *genome_index

    remove_duplicate_reads:
        # depending on sam_to_bam saves us a sort step
        _depends: sam_to_bam

    rm_dup_bam2bed (bam_to_bed):
        _depends: remove_duplicate_reads

    rm_dup_bed2bedgraph (bed_to_bedgraph):
        _depends: rm_dup_bam2bed
        genome: *genome_index
        strand-specific: no

    rm_dup_bedgraph2bigwig (bedgraph_to_bigwig):
        _depends: rm_dup_bed2bedgraph
        genome: *genome_index
   

tools:
    bedtools:
        path: bedtools
        get_version: '--version'
        exit_code: 0
    bedGraphToBigWig:
        path: /data/bioinf/tools/UCSC-tools/bedGraphToBigWig
        get_version: ''
        exit_code: 255
    cat4m:
        path: ./tools/cat4m
    cutadapt:
        path: /home/kaempf/virt-python/bin/cutadapt
        get_version: '--version'
    fix_cutadapt:
        path: ./tools/fix_cutadapt.py
        get_version: '--version'
        exit_code: 0
    fix_s2c:
        path: ['./python_env/bin/python', './tools/fix_s2c.py']
        exit_code: 1
    fix_qnames:
        path: ['./python_env/bin/python', './tools/fix_qnames.py']
    head:
        path: head
        get_version: '--version'
    macs14:
        path: '/data/bioinf/tools/MACS1.4.2/bin/macs14'
        get_version: '--version'
        exit_code: 0
    MarkDuplicates:
        path: MarkDuplicates
        get_version: '--version'
        exit_code: 1
    mate_pair_strand_switch:
        path: ['./python_env/bin/python', './tools/mate_pair_strand_switch.py']
        get_version: '--version' 
        exit_code: 0
    pigz:
        path: pigz
        get_version: '--version'
        exit_code: 0
    remove_reads_segemehl:
        path: ['./python_env/bin/python', './tools/remove_reads_segemehl.py']
        exit_code: 1
    s2c:
        path: ['./python_env/bin/python', 'tools/s2c.py']
        get_version: ''
        exit_code: 2
    samtools:
        path: samtools
        get_version: ''
        exit_code: 1
    segemehl:
        path: '/data/bioinf/projects/code/projects_misc/Tools/SEGEMEHL/segemehl-04182013-mod-stdout-realloc/segemehl.x'
        get_version: ''
        exit_code: 255
    sort:
        path: 'sort'
        get_version: '--version'
        exit_code: 0